"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var status_1 = require("../../../../constant/status");
var http_1 = require("../../../../utils/http");
Page({
    id: 0,
    data: {
        auditing: [],
        join: [],
        refuse: [],
        STATUS: {
            AUDITING: status_1.SIGN_STATUS.AUDITING,
            AWAIT: status_1.SIGN_STATUS.AWAIT,
            JOINING: status_1.SIGN_STATUS.JOINING,
            REFUSE: status_1.SIGN_STATUS.REFUSE
        },
        canSign: false
    },
    onLoad: function (query) {
        var _this = this;
        var activityId = this.id = +query.id;
        console.log(query.status);
        this.setData({ canSign: +query.status === status_1.ACTIVITY_STATUS.PROGRESS });
        http_1.request({
            url: '/api/activity/participation/auditList',
            data: { activityId: activityId }
        })
            .then(function (_a) {
            var list = _a.data;
            var auditing = [];
            var refuse = [];
            var join = [];
            list.forEach(function (v) {
                switch (v.status) {
                    case status_1.SIGN_STATUS.AUDITING:
                        auditing.push(v);
                        break;
                    case status_1.SIGN_STATUS.REFUSE:
                        refuse.push(v);
                        break;
                    case status_1.SIGN_STATUS.AWAIT:
                    case status_1.SIGN_STATUS.JOINING:
                        join.push(v);
                        break;
                    default: break;
                }
            });
            _this.setData({ refuse: refuse, auditing: auditing, join: join });
        })
            .catch(console.log);
    },
    doSign: function (_a) {
        var _this = this;
        var index = _a.currentTarget.dataset.index;
        var item = this.data.join[index];
        if (!item) {
            return;
        }
        wx.showModal({
            title: item.name,
            content: '活动签到确认',
            success: function (_a) {
                var confirm = _a.confirm;
                if (!confirm) {
                    return;
                }
                http_1.request({
                    url: '/api/activity/participation/signIn',
                    data: {
                        activityId: _this.id,
                        user: item.userId
                    }
                })
                    .then(function () {
                    var _a;
                    return _this.setData((_a = {},
                        _a["join[" + index + "].status"] = status_1.SIGN_STATUS.JOINING,
                        _a));
                })
                    .then(function () { return wx.showToast({ title: '签到成功' }); })
                    .catch(console.log);
            }
        });
    },
    doAuit: function (e) {
        var _this = this;
        var isOk = !!e.target.dataset.ok;
        var index = e.currentTarget.dataset.index;
        wx.showModal({
            title: this.data.auditing[index].name,
            content: (!isOk ? '拒绝' : '同意') + '该用户参加该活动?',
            success: function (_a) {
                var confirm = _a.confirm;
                return confirm && _this._doAuit(isOk, index);
            }
        });
    },
    _doAuit: function (isOk, index) {
        var _this = this;
        var _a = this.data, auditing = _a.auditing, refuse = _a.refuse, join = _a.join;
        http_1.request({
            url: '/api/activity/participation/audit',
            data: {
                flag: isOk,
                activityId: this.id,
                userId: auditing[index].userId
            }
        })
            .then(function () {
            wx.showToast({ title: '操作成功' });
            var item = auditing.splice(index, 1)[0];
            item.status = isOk ? status_1.SIGN_STATUS.AWAIT : status_1.SIGN_STATUS.REFUSE;
            (isOk ? join : refuse).push(item);
            _this.setData({ auditing: auditing, join: join, refuse: refuse });
        })
            .catch(console.log);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lnbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInNpZ24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzREFBMkU7QUFDM0UsK0NBQWlEO0FBU2pELElBQUksQ0FBQztJQUNELEVBQUUsRUFBRSxDQUFDO0lBQ0wsSUFBSSxFQUFFO1FBQ0YsUUFBUSxFQUFZLEVBQUU7UUFDdEIsSUFBSSxFQUFZLEVBQUU7UUFDbEIsTUFBTSxFQUFZLEVBQUU7UUFDcEIsTUFBTSxFQUFFO1lBQ0osUUFBUSxFQUFFLG9CQUFXLENBQUMsUUFBUTtZQUM5QixLQUFLLEVBQUUsb0JBQVcsQ0FBQyxLQUFLO1lBQ3hCLE9BQU8sRUFBRSxvQkFBVyxDQUFDLE9BQU87WUFDNUIsTUFBTSxFQUFFLG9CQUFXLENBQUMsTUFBTTtTQUM3QjtRQUNELE9BQU8sRUFBRSxLQUFLO0tBQ2pCO0lBQ0QsTUFBTSxZQUFDLEtBQW1DO1FBQTFDLGlCQWdDQztRQS9CRyxJQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUN2QyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMxQixJQUFJLENBQUMsT0FBUSxDQUFDLEVBQUMsT0FBTyxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyx3QkFBZSxDQUFDLFFBQVEsRUFBQyxDQUFDLENBQUM7UUFDckUsY0FBTyxDQUFXO1lBQ2QsR0FBRyxFQUFFLHVDQUF1QztZQUM1QyxJQUFJLEVBQUUsRUFBRSxVQUFVLFlBQUEsRUFBRTtTQUN2QixDQUFDO2FBQ0csSUFBSSxDQUFDLFVBQUMsRUFBWTtnQkFBWCxjQUFVO1lBQ2QsSUFBTSxRQUFRLEdBQWEsRUFBRSxDQUFDO1lBQzlCLElBQU0sTUFBTSxHQUFhLEVBQUUsQ0FBQztZQUM1QixJQUFNLElBQUksR0FBYSxFQUFFLENBQUM7WUFFMUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFBLENB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LGtCQUFNLEVBQUUsY0FBaUIsQ0FBQztRQUUzQyxjQUFPLENBQUM7WUFDSixHQUFHLEVBQUUsbUNBQW1DO1lBQ3hDLElBQUksRUFBRTtnQkFDRixJQUFJLEVBQUUsSUFBSTtnQkFDVixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUU7Z0JBQ25CLE1BQU0sRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTTthQUNqQztTQUNKLENBQUM7YUFDRCxJQUFJLENBQUM7WUFDRixFQUFFLENBQUMsU0FBUyxDQUFDLEVBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7WUFDL0IsSUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLG9CQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxvQkFBVyxDQUFDLE1BQU0sQ0FBQztZQUM1RCxDQUFDLElBQUksQ0FBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbkMsS0FBSSxDQUFDLE9BQVEsQ0FBQyxFQUFDLFFBQVEsVUFBQSxFQUFFLElBQUksTUFBQSxFQUFFLE1BQU0sUUFBQSxFQUFDLENBQUMsQ0FBQztRQUM1QyxDQUFDLENBQUM7YUFDRCxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7Q0FDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTSUdOX1NUQVRVUywgQUNUSVZJVFlfU1RBVFVTIH0gZnJvbSAnLi4vLi4vLi4vLi4vY29uc3RhbnQvc3RhdHVzJztcclxuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL2h0dHAnO1xyXG5cclxuaW50ZXJmYWNlIEVuSW5mbyB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBwaG9uZTogc3RyaW5nO1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBzdGF0dXM6IFNJR05fU1RBVFVTO1xyXG59XHJcblxyXG5QYWdlKHtcclxuICAgIGlkOiAwLFxyXG4gICAgZGF0YToge1xyXG4gICAgICAgIGF1ZGl0aW5nOiA8RW5JbmZvW10+W10sIC8vIOW+heWuoeaguFxyXG4gICAgICAgIGpvaW46IDxFbkluZm9bXT5bXSwgLy8g5Y+C5Yqg6ICF5YiX6KGoXHJcbiAgICAgICAgcmVmdXNlOiA8RW5JbmZvW10+W10sIC8vIOW3suaLkue7nVxyXG4gICAgICAgIFNUQVRVUzoge1xyXG4gICAgICAgICAgICBBVURJVElORzogU0lHTl9TVEFUVVMuQVVESVRJTkcsXHJcbiAgICAgICAgICAgIEFXQUlUOiBTSUdOX1NUQVRVUy5BV0FJVCxcclxuICAgICAgICAgICAgSk9JTklORzogU0lHTl9TVEFUVVMuSk9JTklORyxcclxuICAgICAgICAgICAgUkVGVVNFOiBTSUdOX1NUQVRVUy5SRUZVU0VcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNhblNpZ246IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgb25Mb2FkKHF1ZXJ5OiB7aWQ6IHN0cmluZywgc3RhdHVzOiBzdHJpbmd9KSB7XHJcbiAgICAgICAgY29uc3QgYWN0aXZpdHlJZCA9IHRoaXMuaWQgPSArcXVlcnkuaWQ7XHJcbiAgICAgICAgY29uc29sZS5sb2cocXVlcnkuc3RhdHVzKTtcclxuICAgICAgICB0aGlzLnNldERhdGEhKHtjYW5TaWduOiArcXVlcnkuc3RhdHVzID09PSBBQ1RJVklUWV9TVEFUVVMuUFJPR1JFU1N9KTtcclxuICAgICAgICByZXF1ZXN0PEVuSW5mb1tdPih7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvYWN0aXZpdHkvcGFydGljaXBhdGlvbi9hdWRpdExpc3QnLFxyXG4gICAgICAgICAgICBkYXRhOiB7IGFjdGl2aXR5SWQgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKCh7ZGF0YTogbGlzdH0pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGl0aW5nOiBFbkluZm9bXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVmdXNlOiBFbkluZm9bXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgam9pbjogRW5JbmZvW10gPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBsaXN0LmZvckVhY2godiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKHYuc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU0lHTl9TVEFUVVMuQVVESVRJTkc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdWRpdGluZy5wdXNoKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU0lHTl9TVEFUVVMuUkVGVVNFOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmdXNlLnB1c2godik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBTSUdOX1NUQVRVUy5BV0FJVDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBTSUdOX1NUQVRVUy5KT0lOSU5HOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgam9pbi5wdXNoKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGF0YSEoe3JlZnVzZSwgYXVkaXRpbmcsIGpvaW59KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgIH0sXHJcbiAgICAvLyDnrb7liLBcclxuICAgIGRvU2lnbih7Y3VycmVudFRhcmdldDoge2RhdGFzZXQ6IHtpbmRleH19fTogQmFzZUV2ZW50PHtpbmRleDogbnVtYmVyfT4pIHtcclxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5kYXRhLmpvaW5baW5kZXhdO1xyXG4gICAgICAgIGlmKCFpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHd4LnNob3dNb2RhbCh7XHJcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6ICfmtLvliqjnrb7liLDnoa7orqQnLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiAoe2NvbmZpcm19KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZighY29uZmlybSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0KHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FjdGl2aXR5L3BhcnRpY2lwYXRpb24vc2lnbkluJyxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2aXR5SWQ6IHRoaXMuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IGl0ZW0udXNlcklkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICAgICAgICAgICAgICAgIFtgam9pblske2luZGV4fV0uc3RhdHVzYF06IFNJR05fU1RBVFVTLkpPSU5JTkdcclxuICAgICAgICAgICAgICAgIH0pKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gd3guc2hvd1RvYXN0KHt0aXRsZTogJ+etvuWIsOaIkOWKnyd9KSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChjb25zb2xlLmxvZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvLyDmiqXlkI3lrqHmoLhcclxuICAgIGRvQXVpdChlOiBCYXNlRXZlbnQ8e29rPzogc3RyaW5nfSwge2luZGV4OiBudW1iZXJ9Pikge1xyXG4gICAgICAgIGNvbnN0IGlzT2sgPSAhIWUudGFyZ2V0LmRhdGFzZXQub2s7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pbmRleDtcclxuXHJcbiAgICAgICAgd3guc2hvd01vZGFsKHtcclxuICAgICAgICAgICAgdGl0bGU6IHRoaXMuZGF0YS5hdWRpdGluZ1tpbmRleF0ubmFtZSxcclxuICAgICAgICAgICAgY29udGVudDogKCFpc09rID8gJ+aLkue7nScgOiAn5ZCM5oSPJykgKyAn6K+l55So5oi35Y+C5Yqg6K+l5rS75YqoPycsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6ICh7Y29uZmlybX0pID0+IGNvbmZpcm0gJiYgdGhpcy5fZG9BdWl0KGlzT2ssIGluZGV4KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIF9kb0F1aXQoaXNPazogYm9vbGVhbiwgaW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHthdWRpdGluZywgcmVmdXNlLCBqb2lufSA9IHRoaXMuZGF0YTtcclxuXHJcbiAgICAgICAgcmVxdWVzdCh7XHJcbiAgICAgICAgICAgIHVybDogJy9hcGkvYWN0aXZpdHkvcGFydGljaXBhdGlvbi9hdWRpdCcsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGZsYWc6IGlzT2ssXHJcbiAgICAgICAgICAgICAgICBhY3Rpdml0eUlkOiB0aGlzLmlkLFxyXG4gICAgICAgICAgICAgICAgdXNlcklkOiBhdWRpdGluZ1tpbmRleF0udXNlcklkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgd3guc2hvd1RvYXN0KHt0aXRsZTogJ+aTjeS9nOaIkOWKnycgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBhdWRpdGluZy5zcGxpY2UoaW5kZXgsIDEpWzBdO1xyXG4gICAgICAgICAgICBpdGVtLnN0YXR1cyA9IGlzT2sgPyBTSUdOX1NUQVRVUy5BV0FJVCA6IFNJR05fU1RBVFVTLlJFRlVTRTtcclxuICAgICAgICAgICAgKGlzT2sgID8gam9pbiA6IHJlZnVzZSkucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgdGhpcy5zZXREYXRhISh7YXVkaXRpbmcsIGpvaW4sIHJlZnVzZX0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgIH1cclxufSk7XHJcbiJdfQ==