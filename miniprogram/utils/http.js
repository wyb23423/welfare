"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
Object.defineProperty(exports, "__esModule", { value: true });
var index_1 = require("../constant/index");
var store_1 = require("../constant/store");
function handle(method, options) {
    var fail = options.fail;
    var success = options.success;
    options.url = index_1.HOST + options.url;
    options.header = __assign({ cookie: wx.getStorageSync(store_1.COOKIE) }, (options.header || {}));
    return new Promise(function (resolve, reject) {
        options.success = function (res) {
            if (typeof res.data === 'string') {
                res.data = JSON.parse(res.data);
            }
            if (isSucess(res)) {
                success && success(res);
                resolve(res.data);
            }
            else {
                var errMsg = '';
                if (!(res.data instanceof ArrayBuffer || typeof res.data === 'string')) {
                    errMsg = res.data.msg;
                }
                if (errMsg && !options.notShowMsg) {
                    wx.showToast({
                        title: errMsg,
                        icon: 'none'
                    });
                }
                fail && fail({ errMsg: errMsg });
                reject({ errMsg: errMsg });
            }
        };
        options.fail = function (res) {
            fail && fail(res);
            reject(res);
        };
        wx[method](options);
    });
}
function isSucess(res) {
    var code = 200;
    if (res.data && !(res.data instanceof ArrayBuffer || typeof res.data === 'string')) {
        code = res.data.code;
    }
    return res.statusCode >= 200 && res.statusCode < 300 && code >= 200 && code < 300;
}
function request(options) {
    return handle('request', options);
}
exports.request = request;
function uploadFile(options) {
    options.name = options.name || 'file';
    return handle('uploadFile', options);
}
exports.uploadFile = uploadFile;
function downloadFile(options) {
    var fail = options.fail;
    options.url = index_1.HOST + options.url;
    options.header = __assign({ cookie: wx.getStorageSync(store_1.COOKIE) }, (options.header || {}));
    return new Promise(function (resolve, reject) {
        options.success = function (response) {
            if (response.statusCode >= 200 && response.statusCode < 300) {
                resolve(response);
            }
            else {
                var errMsg = '文件下载失败';
                wx.showToast({
                    title: errMsg,
                    icon: 'none'
                });
                fail && fail({ errMsg: errMsg });
                reject();
            }
        };
        options.fail = function (res) {
            fail && fail(res);
            reject(res);
        };
        wx.downloadFile(options);
    });
}
exports.downloadFile = downloadFile;
function saveFile(path, ext) {
    var savePath = wx.env.USER_DATA_PATH + '/' + Date.now() + '.jpg';
    wx.getFileSystemManager().saveFile({
        tempFilePath: path,
        filePath: savePath,
        success: function () {
            wx.saveImageToPhotosAlbum({
                filePath: savePath,
                success: function () {
                    wx.showModal({
                        title: '文件已保存到手机相册',
                        content: "\u4F4D\u4E8Etencent/MicroMsg/WeiXin\u4E0B \r\n\u5C06\u4FDD\u5B58\u7684\u6587\u4EF6\u91CD\u547D\u540D\u6539\u4E3A[ ." + ext + " ]\u540E\u7F00\u5373\u53EF",
                        confirmColor: '#0bc183',
                        confirmText: '知道了',
                        showCancel: false
                    });
                },
                fail: function (res) { console.log(res); }
            });
        },
        fail: function (res) { console.log(res); }
    });
}
exports.saveFile = saveFile;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImh0dHAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUF5QztBQUN6QywyQ0FBMkM7QUFFM0MsU0FBUyxNQUFNLENBQ1gsTUFBZ0MsRUFDaEMsT0FBMEU7SUFFMUUsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztJQUMxQixJQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO0lBRWhDLE9BQU8sQ0FBQyxHQUFHLEdBQUcsWUFBSSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7SUFDakMsT0FBTyxDQUFDLE1BQU0sY0FBSyxNQUFNLEVBQUUsRUFBRSxDQUFDLGNBQWMsQ0FBQyxjQUFNLENBQUMsSUFBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLElBQUksRUFBRSxDQUFDLENBQUUsQ0FBQztJQUVsRixPQUFPLElBQUksT0FBTyxDQUFDLFVBQUMsT0FBTyxFQUFFLE1BQU07UUFDL0IsT0FBTyxDQUFDLE9BQU8sR0FBRyxVQUFDLEdBQVE7WUFDdkIsSUFBSSxPQUFPLEdBQUcsQ0FBQyxJQUFJLEtBQUssUUFBUSxFQUFFO2dCQUM5QixHQUFHLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQ25DO1lBRUQsSUFBSSxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQ2YsT0FBTyxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNyQjtpQkFBTTtnQkFDSCxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUM7Z0JBQ2hCLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLFlBQVksV0FBVyxJQUFJLE9BQU8sR0FBRyxDQUFDLElBQUksS0FBSyxRQUFRLENBQUMsRUFBRTtvQkFDcEUsTUFBTSxHQUFrQixH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RyxDQUFDLENBQUM7WUFDbEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLENBQUMsQ0FBQztRQUVGLEVBQUUsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDN0IsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBNUJELG9DQTRCQztBQU9ELFNBQWdCLFFBQVEsQ0FBQyxJQUFZLEVBQUUsR0FBVztJQUU5QyxJQUFNLFFBQVEsR0FBUyxFQUFHLENBQUMsR0FBRyxDQUFDLGNBQWMsR0FBRyxHQUFHLEdBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFFLE1BQU0sQ0FBQztJQUN4RSxFQUFFLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxRQUFRLENBQUM7UUFDL0IsWUFBWSxFQUFFLElBQUk7UUFDbEIsUUFBUSxFQUFFLFFBQVE7UUFDbEIsT0FBTztZQUVILEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQztnQkFDdEIsUUFBUSxFQUFFLFFBQVE7Z0JBQ2xCLE9BQU8sRUFBRTtvQkFFTCxFQUFFLENBQUMsU0FBUyxDQUFDO3dCQUNULEtBQUssRUFBRSxZQUFZO3dCQUNuQixPQUFPLEVBQUUsd0hBQWdELEdBQUcsK0JBQVE7d0JBQ3BFLFlBQVksRUFBRSxTQUFTO3dCQUN2QixXQUFXLEVBQUUsS0FBSzt3QkFDbEIsVUFBVSxFQUFFLEtBQUs7cUJBQ3BCLENBQUMsQ0FBQztnQkFDUCxDQUFDO2dCQUNELElBQUksWUFBQyxHQUFHLElBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBLENBQUM7YUFDaEMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQztRQUNELElBQUksWUFBQyxHQUFHLElBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBLENBQUM7S0FDaEMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQXpCRCw0QkF5QkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIT1NUIH0gZnJvbSAnLi4vY29uc3RhbnQvaW5kZXgnO1xyXG5pbXBvcnQgeyBDT09LSUUgfSBmcm9tICcuLi9jb25zdGFudC9zdG9yZSc7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGU8VD4oXHJcbiAgICBtZXRob2Q6ICdyZXF1ZXN0JyB8ICd1cGxvYWRGaWxlJyxcclxuICAgIG9wdGlvbnM6ICh3eC5SZXF1ZXN0T3B0aW9uIHwgd3guVXBsb2FkRmlsZU9wdGlvbikgJiB7bm90U2hvd01zZz86IGJvb2xlYW59XHJcbik6IFByb21pc2U8UmVzcG9uc2VEYXRhPFQ+PiB7XHJcbiAgICBjb25zdCBmYWlsID0gb3B0aW9ucy5mYWlsO1xyXG4gICAgY29uc3Qgc3VjY2VzcyA9IG9wdGlvbnMuc3VjY2VzcztcclxuXHJcbiAgICBvcHRpb25zLnVybCA9IEhPU1QgKyBvcHRpb25zLnVybDtcclxuICAgIG9wdGlvbnMuaGVhZGVyID0geyBjb29raWU6IHd4LmdldFN0b3JhZ2VTeW5jKENPT0tJRSksIC4uLihvcHRpb25zLmhlYWRlciB8fCB7fSkgfTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIG9wdGlvbnMuc3VjY2VzcyA9IChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHJlcy5kYXRhID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgcmVzLmRhdGEgPSBKU09OLnBhcnNlKHJlcy5kYXRhKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGlzU3VjZXNzKHJlcykpIHtcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3MgJiYgc3VjY2VzcyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMuZGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZXJyTXNnID0gJyc7XHJcbiAgICAgICAgICAgICAgICBpZiAoIShyZXMuZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IHR5cGVvZiByZXMuZGF0YSA9PT0gJ3N0cmluZycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyTXNnID0gKDxSZXNwb25zZURhdGE+cmVzLmRhdGEpLm1zZztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyTXNnICYmICFvcHRpb25zLm5vdFNob3dNc2cpIHtcclxuICAgICAgICAgICAgICAgICAgICB3eC5zaG93VG9hc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZXJyTXNnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAnbm9uZSdcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmYWlsICYmIGZhaWwoeyBlcnJNc2cgfSk7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoeyBlcnJNc2cgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIG9wdGlvbnMuZmFpbCA9IChyZXM6IHd4LkdlbmVyYWxDYWxsYmFja1Jlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICBmYWlsICYmIGZhaWwocmVzKTtcclxuICAgICAgICAgICAgcmVqZWN0KHJlcyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgd3hbbWV0aG9kXSg8YW55Pm9wdGlvbnMpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbnR5cGUgUmVzID0gd3guUmVxdWVzdFN1Y2Nlc3NDYWxsYmFja1Jlc3VsdCB8IHd4LlVwbG9hZEZpbGVTdWNjZXNzQ2FsbGJhY2tSZXN1bHQ7XHJcbmZ1bmN0aW9uIGlzU3VjZXNzKHJlczogUmVzKSB7XHJcbiAgICBsZXQgY29kZSA9IDIwMDtcclxuICAgIGlmIChyZXMuZGF0YSAmJiAhKHJlcy5kYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgdHlwZW9mIHJlcy5kYXRhID09PSAnc3RyaW5nJykpIHtcclxuICAgICAgICBjb2RlID0gKDxSZXNwb25zZURhdGE+cmVzLmRhdGEpLmNvZGU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXNDb2RlID49IDIwMCAmJiByZXMuc3RhdHVzQ29kZSA8IDMwMCAmJiBjb2RlID49IDIwMCAmJiBjb2RlIDwgMzAwO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVxdWVzdDxUPihvcHRpb25zOiB3eC5SZXF1ZXN0T3B0aW9uICYge25vdFNob3dNc2c/OiBib29sZWFufSkge1xyXG4gICAgcmV0dXJuIGhhbmRsZTxUPigncmVxdWVzdCcsIG9wdGlvbnMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBsb2FkRmlsZTxUPihvcHRpb25zOiB3eC5VcGxvYWRGaWxlT3B0aW9uICYge25vdFNob3dNc2c/OiBib29sZWFufSkge1xyXG4gICAgb3B0aW9ucy5uYW1lID0gb3B0aW9ucy5uYW1lIHx8ICdmaWxlJztcclxuXHJcbiAgICByZXR1cm4gaGFuZGxlPFQ+KCd1cGxvYWRGaWxlJywgb3B0aW9ucyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkb3dubG9hZEZpbGUob3B0aW9uczogd3guRG93bmxvYWRGaWxlT3B0aW9uKTogUHJvbWlzZTx3eC5Eb3dubG9hZEZpbGVTdWNjZXNzQ2FsbGJhY2tSZXN1bHQ+IHtcclxuICAgIGNvbnN0IGZhaWwgPSBvcHRpb25zLmZhaWw7XHJcblxyXG4gICAgb3B0aW9ucy51cmwgPSBIT1NUICsgb3B0aW9ucy51cmw7XHJcbiAgICBvcHRpb25zLmhlYWRlciA9IHsgY29va2llOiB3eC5nZXRTdG9yYWdlU3luYyhDT09LSUUpLCAuLi4ob3B0aW9ucy5oZWFkZXIgfHwge30pIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBvcHRpb25zLnN1Y2Nlc3MgPSAocmVzcG9uc2U6IHd4LkRvd25sb2FkRmlsZVN1Y2Nlc3NDYWxsYmFja1Jlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8IDMwMCkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJNc2cgPSAn5paH5Lu25LiL6L295aSx6LSlJztcclxuICAgICAgICAgICAgICAgIHd4LnNob3dUb2FzdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGVyck1zZyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uOiAnbm9uZSdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGZhaWwgJiYgZmFpbCh7ZXJyTXNnfSk7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgb3B0aW9ucy5mYWlsID0gKHJlczogd3guR2VuZXJhbENhbGxiYWNrUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgIGZhaWwgJiYgZmFpbChyZXMpO1xyXG4gICAgICAgICAgICByZWplY3QocmVzKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB3eC5kb3dubG9hZEZpbGUob3B0aW9ucyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOS/neWtmOmZpOWbvueJh+OAgeinhumikeS7peWklueahOaWh+S7tlxyXG4gKiBAcGFyYW0gcGF0aCDot6/lvoRcclxuICogQHBhcmFtIGZpbGVUeXBlIOaJqeWxleWQjVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVGaWxlKHBhdGg6IHN0cmluZywgZXh0OiBzdHJpbmcpIHtcclxuICAgIC8vIOagueaNruS4tOaXtui3r+W+hOS/neWtmOaWh+S7tlxyXG4gICAgY29uc3Qgc2F2ZVBhdGggPSAoPGFueT53eCkuZW52LlVTRVJfREFUQV9QQVRIICsgJy8nKyBEYXRlLm5vdygpICsnLmpwZyc7XHJcbiAgICB3eC5nZXRGaWxlU3lzdGVtTWFuYWdlcigpLnNhdmVGaWxlKHsvLyDkuIvovb3miJDlip/lkI7kv53lrZjliLDmnKzlnLBcclxuICAgICAgICB0ZW1wRmlsZVBhdGg6IHBhdGgsXHJcbiAgICAgICAgZmlsZVBhdGg6IHNhdmVQYXRoLFxyXG4gICAgICAgIHN1Y2Nlc3MoKSB7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluS6huebuOWGjOeahOiuv+mXruadg+mZkO+8jOS9v+eUqCB3eC5zYXZlSW1hZ2VUb1Bob3Rvc0FsYnVtIOWwhuWbvueJh+S/neWtmOWIsOebuOWGjOS4rVxyXG4gICAgICAgICAgICB3eC5zYXZlSW1hZ2VUb1Bob3Rvc0FsYnVtKHtcclxuICAgICAgICAgICAgICAgIGZpbGVQYXRoOiBzYXZlUGF0aCAsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5L+d5a2Y5oiQ5Yqf5by55Ye65o+Q56S677yM5ZGK55+l5LiA5LiL55So5oi3XHJcbiAgICAgICAgICAgICAgICAgICAgd3guc2hvd01vZGFsKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfmlofku7blt7Lkv53lrZjliLDmiYvmnLrnm7jlhownLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBg5L2N5LqOdGVuY2VudC9NaWNyb01zZy9XZWlYaW7kuIsgXFxyXFxu5bCG5L+d5a2Y55qE5paH5Lu26YeN5ZG95ZCN5pS55Li6WyAuJHtleHR9IF3lkI7nvIDljbPlj69gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQ29sb3I6ICcjMGJjMTgzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybVRleHQ6ICfnn6XpgZPkuoYnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FuY2VsOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZhaWwocmVzKSB7Y29uc29sZS5sb2cocmVzKTt9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZmFpbChyZXMpIHtjb25zb2xlLmxvZyhyZXMpO31cclxuICAgIH0pO1xyXG59XHJcbiJdfQ==