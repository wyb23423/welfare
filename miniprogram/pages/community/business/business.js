"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var page_query_1 = require("../../../behavior/page_query");
var status_1 = require("../../../constant/status");
var http_1 = require("../../../utils/http");
var store_1 = require("../../../constant/store");
Component({
    behaviors: [page_query_1.default],
    data: {
        url: '/api/merchant/list',
        BANNED: status_1.BUSINESS_STATUS.BANNED
    },
    pageLifetimes: {
        show: function () {
            this.onShow();
        }
    },
    methods: {
        liftOrBan: function (_a) {
            var _this = this;
            var index = _a.currentTarget.dataset.index;
            var list = this.data.list;
            var item = list[index];
            var isBan = item.authentication !== status_1.BUSINESS_STATUS.BANNED;
            wx.showModal({
                content: (isBan ? '禁止' : '解禁') + '该组织的权限？',
                success: function (_a) {
                    var confirm = _a.confirm;
                    if (!confirm) {
                        return;
                    }
                    var authentication = status_1.BUSINESS_STATUS.BANNED;
                    if (!isBan) {
                        var isCommunity = wx.getStorageSync(store_1.IS_OFFICIAL);
                        authentication = isCommunity ? status_1.BUSINESS_STATUS.COMMUNITY : status_1.BUSINESS_STATUS.NORMAL;
                    }
                    http_1.request({ url: '/api/merchant', method: 'POST', data: { id: item.id, authentication: authentication } })
                        .then(function () {
                        var _a;
                        wx.showToast({ title: '操作成功' });
                        _this.setData((_a = {}, _a["list[" + index + "].authentication"] = authentication, _a));
                    })
                        .catch(console.log);
                }
            });
        },
        delete: function (_a) {
            var index = _a.currentTarget.dataset.index;
            var list = this.data.list;
            var item = list[index];
            wx.showModal({
                content: '删除该组织？',
                success: function (_a) {
                    var confirm = _a.confirm;
                    if (!confirm) {
                        return;
                    }
                    console.log(item);
                }
            });
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVzaW5lc3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJidXNpbmVzcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUlBLDJEQUF3RTtBQUN4RSxtREFBMkQ7QUFDM0QsNENBQThDO0FBQzlDLGlEQUFzRDtBQUV0RCxTQUFTLENBQWdCO0lBQ3JCLFNBQVMsRUFBRSxDQUFDLG9CQUFTLENBQUM7SUFDdEIsSUFBSSxFQUFFO1FBQ0YsR0FBRyxFQUFFLG9CQUFvQjtRQUN6QixNQUFNLEVBQUUsd0JBQWUsQ0FBQyxNQUFNO0tBQ2pDO0lBQ0QsYUFBYSxFQUFFO1FBQ1gsSUFBSTtZQUNBLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNsQixDQUFDO0tBQ0o7SUFDRCxPQUFPLEVBQUU7UUFDTCxTQUFTLFlBQUMsRUFBK0Q7WUFBekUsaUJBeUJDO2dCQXpCb0Msc0NBQUs7WUFDdEMsSUFBTSxJQUFJLEdBQWdCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQ3pDLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN6QixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsY0FBYyxLQUFLLHdCQUFlLENBQUMsTUFBTSxDQUFDO1lBRTdELEVBQUUsQ0FBQyxTQUFTLENBQUM7Z0JBQ1QsT0FBTyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLFNBQVM7Z0JBQzFDLE9BQU8sRUFBRSxVQUFDLEVBQVM7d0JBQVIsb0JBQU87b0JBQ2QsSUFBRyxDQUFDLE9BQU8sRUFBRTt3QkFDVCxPQUFPO3FCQUNWO29CQUVELElBQUksY0FBYyxHQUFHLHdCQUFlLENBQUMsTUFBTSxDQUFDO29CQUM1QyxJQUFHLENBQUMsS0FBSyxFQUFFO3dCQUNQLElBQU0sV0FBVyxHQUFHLEVBQUUsQ0FBQyxjQUFjLENBQUMsbUJBQVcsQ0FBQyxDQUFDO3dCQUNuRCxjQUFjLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQyx3QkFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsd0JBQWUsQ0FBQyxNQUFNLENBQUM7cUJBQ3JGO29CQUNELGNBQU8sQ0FBQyxFQUFFLEdBQUcsRUFBRSxlQUFlLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsRUFBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxjQUFjLGdCQUFBLEVBQUMsRUFBRSxDQUFDO3lCQUNqRixJQUFJLENBQUM7O3dCQUNGLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBQyxLQUFLLEVBQUUsTUFBTSxFQUFDLENBQUMsQ0FBQzt3QkFDOUIsS0FBSSxDQUFDLE9BQU8sV0FBRSxHQUFDLFVBQVEsS0FBSyxxQkFBa0IsSUFBRyxjQUFjLE1BQUUsQ0FBQztvQkFDdEUsQ0FBQyxDQUFDO3lCQUNELEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQzVCLENBQUM7YUFDSixDQUFDLENBQUM7UUFDUCxDQUFDO1FBQ0QsTUFBTSxZQUFDLEVBQStEO2dCQUFwQyxzQ0FBSztZQUNuQyxJQUFNLElBQUksR0FBZ0IsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7WUFDekMsSUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXpCLEVBQUUsQ0FBQyxTQUFTLENBQUM7Z0JBQ1QsT0FBTyxFQUFFLFFBQVE7Z0JBQ2pCLE9BQU8sRUFBRSxVQUFDLEVBQVM7d0JBQVIsb0JBQU87b0JBQ2QsSUFBRyxDQUFDLE9BQU8sRUFBRTt3QkFDVCxPQUFPO3FCQUNWO29CQUdELE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ3RCLENBQUM7YUFDSixDQUFDLENBQUM7UUFDUCxDQUFDO0tBQ0o7Q0FDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuLyoqXHJcbiAqIOe7hOe7h+WIl+ihqCjnrqHnkIYpXHJcbiAqL1xyXG5pbXBvcnQgUGFnZVF1ZXJ5LCB7IExpc3RDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9iZWhhdmlvci9wYWdlX3F1ZXJ5JztcclxuaW1wb3J0IHsgQlVTSU5FU1NfU1RBVFVTIH0gZnJvbSAnLi4vLi4vLi4vY29uc3RhbnQvc3RhdHVzJztcclxuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2h0dHAnO1xyXG5pbXBvcnQgeyBJU19PRkZJQ0lBTCB9IGZyb20gJy4uLy4uLy4uL2NvbnN0YW50L3N0b3JlJztcclxuXHJcbkNvbXBvbmVudDxMaXN0Q29tcG9uZW50Pih7XHJcbiAgICBiZWhhdmlvcnM6IFtQYWdlUXVlcnldLFxyXG4gICAgZGF0YToge1xyXG4gICAgICAgIHVybDogJy9hcGkvbWVyY2hhbnQvbGlzdCcsXHJcbiAgICAgICAgQkFOTkVEOiBCVVNJTkVTU19TVEFUVVMuQkFOTkVEXHJcbiAgICB9LFxyXG4gICAgcGFnZUxpZmV0aW1lczoge1xyXG4gICAgICAgIHNob3codGhpczogTGlzdENvbXBvbmVudCkge1xyXG4gICAgICAgICAgICB0aGlzLm9uU2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBtZXRob2RzOiB7XHJcbiAgICAgICAgbGlmdE9yQmFuKHtjdXJyZW50VGFyZ2V0OiB7ZGF0YXNldDoge2luZGV4fX19OiBCYXNlRXZlbnQ8e2luZGV4OiBudW1iZXJ9Pikge1xyXG4gICAgICAgICAgICBjb25zdCBsaXN0OiBJTWVyY2hhbnRbXSA9IHRoaXMuZGF0YS5saXN0O1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0gbGlzdFtpbmRleF07XHJcbiAgICAgICAgICAgIGNvbnN0IGlzQmFuID0gaXRlbS5hdXRoZW50aWNhdGlvbiAhPT0gQlVTSU5FU1NfU1RBVFVTLkJBTk5FRDtcclxuXHJcbiAgICAgICAgICAgIHd4LnNob3dNb2RhbCh7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50OiAoaXNCYW4gPyAn56aB5q2iJyA6ICfop6PnpoEnKSArICfor6Xnu4Tnu4fnmoTmnYPpmZDvvJ8nLFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogKHtjb25maXJtfSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFjb25maXJtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhdXRoZW50aWNhdGlvbiA9IEJVU0lORVNTX1NUQVRVUy5CQU5ORUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIWlzQmFuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ29tbXVuaXR5ID0gd3guZ2V0U3RvcmFnZVN5bmMoSVNfT0ZGSUNJQUwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoZW50aWNhdGlvbiA9IGlzQ29tbXVuaXR5ID8gQlVTSU5FU1NfU1RBVFVTLkNPTU1VTklUWSA6IEJVU0lORVNTX1NUQVRVUy5OT1JNQUw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3QoeyB1cmw6ICcvYXBpL21lcmNoYW50JywgbWV0aG9kOiAnUE9TVCcsIGRhdGE6IHtpZDogaXRlbS5pZCwgYXV0aGVudGljYXRpb259IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHd4LnNob3dUb2FzdCh7dGl0bGU6ICfmk43kvZzmiJDlip8nfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldERhdGEoe1tgbGlzdFske2luZGV4fV0uYXV0aGVudGljYXRpb25gXTogYXV0aGVudGljYXRpb259KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkZWxldGUoe2N1cnJlbnRUYXJnZXQ6IHtkYXRhc2V0OiB7aW5kZXh9fX06IEJhc2VFdmVudDx7aW5kZXg6IG51bWJlcn0+KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3Q6IElNZXJjaGFudFtdID0gdGhpcy5kYXRhLmxpc3Q7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBsaXN0W2luZGV4XTtcclxuXHJcbiAgICAgICAgICAgIHd4LnNob3dNb2RhbCh7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50OiAn5Yig6Zmk6K+l57uE57uH77yfJyxcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICh7Y29uZmlybX0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZighY29uZmlybSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7XHJcbiJdfQ==