"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var http_1 = require("../../../utils/http");
var util_1 = require("../../../utils/util");
Page({
    activity: null,
    goods: null,
    data: {
        history: [],
        type: '',
        tabType: 0
    },
    onLoad: function (query) {
        this.data.type = query.type;
        var type = "_" + query.type;
        this[type] && this[type]();
        var titles = {
            await: '待参加',
            auditing: '待审核',
            complete: '已参加',
            evaluate: '待评价',
            collection: '我的收藏'
        };
        wx.setNavigationBarTitle({
            title: titles[query.type]
        });
    },
    delete: function (e) {
        var _this = this;
        var index = +e.target.dataset.index;
        var _a = this.data, history = _a.history, type = _a.type;
        var isCollection = type === 'collection';
        wx.showModal({
            content: isCollection ? '取消收藏？' : '删除该活动记录？',
            success: function (res) {
                if (res.confirm) {
                    if (isCollection) {
                        return _this._cancelCollect(index);
                    }
                    http_1.request({
                        url: '/api/activity/participation',
                        method: 'DELETE',
                        data: { activityId: history[index].id }
                    })
                        .then(function () {
                        wx.showToast({ title: '删除成功' });
                        history.splice(index, 1);
                        _this.setData({ history: history });
                    })
                        .catch(console.log);
                }
            }
        });
    },
    none: function () {
    },
    switch: function (e) {
        var type = +e.target.dataset.type;
        this.data.tabType = type;
        var another = type ? this.goods : this.activity;
        if (another) {
            this.data.history = another;
            return this.setData(this.data);
        }
        this._collection();
    },
    _cancelCollect: function (index) {
        var _this = this;
        var history = this.data.history;
        http_1.request({
            url: '/api/like',
            method: 'DELETE',
            data: {
                targetId: history[index].id,
                type: this.data.tabType
            }
        })
            .then(function () {
            wx.showToast({ title: '取消搜藏成功' });
            history.splice(index, 1);
            _this.setData({ history: history });
        })
            .catch(console.log);
    },
    _await: function () {
        this._request('/api/activity/participation/list/await');
    },
    _auditing: function () {
        this._request('/api/activity/participation/list/auditing');
    },
    _complete: function () {
        this._request('/api/activity/participation/list/complete');
    },
    _evaluate: function () {
        this._request('/api/activity/participation/list/evaluate');
    },
    _collection: function () {
        var _this = this;
        var tabType = this.data.tabType;
        http_1.request({
            url: '/api/like',
            data: { type: tabType }
        })
            .then(function (_a) {
            var data = _a.data;
            var list = data.map(util_1.parseData);
            _this[tabType ? 'goods' : 'activity'] = list;
            _this.setData({
                history: list,
                type: _this.data.type,
                tabType: tabType
            });
        })
            .catch(console.log);
    },
    _request: function (url) {
        var _this = this;
        http_1.request({ url: url })
            .then(function (_a) {
            var data = _a.data;
            return _this.setData({ type: _this.data.type, history: data.map(util_1.parseData) });
        })
            .catch(console.log);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlzdG9yeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImhpc3RvcnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw0Q0FBOEM7QUFDOUMsNENBQWdEO0FBSWhELElBQUksQ0FBQztJQUNELFFBQVEsRUFBb0IsSUFBSTtJQUNoQyxLQUFLLEVBQXVCLElBQUk7SUFDaEMsSUFBSSxFQUFFO1FBQ0YsT0FBTyxFQUFFLEVBQWlDO1FBQzFDLElBQUksRUFBRSxFQUFFO1FBQ1IsT0FBTyxFQUFFLENBQUM7S0FDYjtJQUNELE1BQU0sWUFBQyxLQUFpQjtRQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDO1FBRTVCLElBQU0sSUFBSSxHQUFnQixNQUFJLEtBQUssQ0FBQyxJQUFNLENBQUM7UUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBRTNCLElBQU0sTUFBTSxHQUFRO1lBQ2hCLEtBQUssRUFBRSxLQUFLO1lBQ1osUUFBUSxFQUFFLEtBQUs7WUFDZixRQUFRLEVBQUUsS0FBSztZQUNmLFFBQVEsRUFBRSxLQUFLO1lBQ2YsVUFBVSxFQUFFLE1BQU07U0FDckIsQ0FBQztRQUNGLEVBQUUsQ0FBQyxxQkFBcUIsQ0FBQztZQUNyQixLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUM7U0FDNUIsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELE1BQU0sWUFBQyxDQUFlO1FBQXRCLGlCQTRCQztRQTNCRyxJQUFNLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQztRQUNoQyxJQUFBLGNBQTJCLEVBQTFCLG9CQUFPLEVBQUUsY0FBaUIsQ0FBQztRQUVsQyxJQUFNLFlBQVksR0FBRyxJQUFJLEtBQUssWUFBWSxDQUFDO1FBRTNDLEVBQUUsQ0FBQyxTQUFTLENBQUM7WUFDVCxP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aUJBZ0JDO1FBZkcsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDbEMsY0FBTyxDQUEyQjtZQUM5QixHQUFHLEVBQUUsV0FBVztZQUNoQixJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1NBQzFCLENBQUM7YUFDRyxJQUFJLENBQUMsVUFBQyxFQUFRO2dCQUFOLGNBQUk7WUFDVCxJQUFNLElBQUksR0FBVyxJQUFLLENBQUMsR0FBRyxDQUFDLGdCQUFTLENBQUMsQ0FBQztZQUMxQyxLQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxHQUFHLElBQUksQ0FBQztZQUM1QyxLQUFJLENBQUMsT0FBUSxDQUFDO2dCQUNWLE9BQU8sRUFBRSxJQUFJO2dCQUNiLElBQUksRUFBRSxLQUFJLENBQUMsSUFBSSxDQUFDLElBQUk7Z0JBQ3BCLE9BQU8sU0FBQTthQUNWLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQzthQUNELEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUNELFFBQVEsWUFBQyxHQUFXO1FBQXBCLGlCQUlDO1FBSEcsY0FBTyxDQUFZLEVBQUUsR0FBRyxLQUFBLEVBQUUsQ0FBQzthQUN0QixJQUFJLENBQUMsVUFBQyxFQUFRO2dCQUFOLGNBQUk7WUFBTyxPQUFBLEtBQUksQ0FBQyxPQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsZ0JBQVMsQ0FBQyxFQUFFLENBQUM7UUFBckUsQ0FBcUUsQ0FBQzthQUN6RixLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzVCLENBQUM7Q0FDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvaHR0cCc7XHJcbmltcG9ydCB7IHBhcnNlRGF0YSB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWwnO1xyXG5cclxudHlwZSBIaXN0b3J5VHlwZSA9ICdfYXdhaXQnIHwgJ19hdWRpdGluZycgfCAnX2NvbXBsZXRlJyB8ICdfZXZhbHVhdGUnIHwgJ19jb2xsZWN0aW9uJztcclxuXHJcblBhZ2Uoe1xyXG4gICAgYWN0aXZpdHk6IDxJQWN0aXZlW10gfCBudWxsPm51bGwsXHJcbiAgICBnb29kczogPElDb21tb2RpdHlbXSB8IG51bGw+bnVsbCxcclxuICAgIGRhdGE6IHtcclxuICAgICAgICBoaXN0b3J5OiBbXSBhcyBBcnJheTxJQWN0aXZlIHwgSUNvbW1vZGl0eT4sXHJcbiAgICAgICAgdHlwZTogJycsXHJcbiAgICAgICAgdGFiVHlwZTogMFxyXG4gICAgfSxcclxuICAgIG9uTG9hZChxdWVyeTogSUFueU9iamVjdCkge1xyXG4gICAgICAgIHRoaXMuZGF0YS50eXBlID0gcXVlcnkudHlwZTtcclxuXHJcbiAgICAgICAgY29uc3QgdHlwZSA9IDxIaXN0b3J5VHlwZT5gXyR7cXVlcnkudHlwZX1gO1xyXG4gICAgICAgIHRoaXNbdHlwZV0gJiYgdGhpc1t0eXBlXSgpO1xyXG5cclxuICAgICAgICBjb25zdCB0aXRsZXM6IGFueSA9IHtcclxuICAgICAgICAgICAgYXdhaXQ6ICflvoXlj4LliqAnLFxyXG4gICAgICAgICAgICBhdWRpdGluZzogJ+W+heWuoeaguCcsXHJcbiAgICAgICAgICAgIGNvbXBsZXRlOiAn5bey5Y+C5YqgJyxcclxuICAgICAgICAgICAgZXZhbHVhdGU6ICflvoXor4Tku7cnLFxyXG4gICAgICAgICAgICBjb2xsZWN0aW9uOiAn5oiR55qE5pS26JePJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgd3guc2V0TmF2aWdhdGlvbkJhclRpdGxlKHtcclxuICAgICAgICAgICAgdGl0bGU6IHRpdGxlc1txdWVyeS50eXBlXVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGRlbGV0ZShlOiBXeFRvdWNoRXZlbnQpIHtcclxuICAgICAgICBjb25zdCBpbmRleCA9ICtlLnRhcmdldC5kYXRhc2V0LmluZGV4O1xyXG4gICAgICAgIGNvbnN0IHtoaXN0b3J5LCB0eXBlfSA9IHRoaXMuZGF0YTtcclxuXHJcbiAgICAgICAgY29uc3QgaXNDb2xsZWN0aW9uID0gdHlwZSA9PT0gJ2NvbGxlY3Rpb24nO1xyXG5cclxuICAgICAgICB3eC5zaG93TW9kYWwoe1xyXG4gICAgICAgICAgICBjb250ZW50OiBpc0NvbGxlY3Rpb24gPyAn5Y+W5raI5pS26JeP77yfJyA6ICfliKDpmaTor6XmtLvliqjorrDlvZXvvJ8nLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiAocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLmNvbmZpcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNDb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYW5jZWxDb2xsZWN0KGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBpL2FjdGl2aXR5L3BhcnRpY2lwYXRpb24nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGFjdGl2aXR5SWQ6IGhpc3RvcnlbaW5kZXhdLmlkIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3eC5zaG93VG9hc3QoeyB0aXRsZTogJ+WIoOmZpOaIkOWKnycgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldERhdGEhKHsgaGlzdG9yeSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIG5vbmUoKSB7XHJcbiAgICAgICAgLy9cclxuICAgIH0sXHJcbiAgICBzd2l0Y2goZTogV3hUb3VjaEV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgdHlwZSA9ICtlLnRhcmdldC5kYXRhc2V0LnR5cGU7XHJcbiAgICAgICAgdGhpcy5kYXRhLnRhYlR5cGUgPSB0eXBlO1xyXG4gICAgICAgIGNvbnN0IGFub3RoZXIgPSB0eXBlID8gdGhpcy5nb29kcyA6IHRoaXMuYWN0aXZpdHk7XHJcblxyXG4gICAgICAgIGlmIChhbm90aGVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5oaXN0b3J5ID0gYW5vdGhlcjtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0RGF0YSEodGhpcy5kYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2NvbGxlY3Rpb24oKTtcclxuICAgIH0sXHJcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICBfY2FuY2VsQ29sbGVjdChpbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgaGlzdG9yeSA9IHRoaXMuZGF0YS5oaXN0b3J5O1xyXG5cclxuICAgICAgICByZXF1ZXN0KHtcclxuICAgICAgICAgICAgdXJsOiAnL2FwaS9saWtlJyxcclxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IGhpc3RvcnlbaW5kZXhdLmlkLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogdGhpcy5kYXRhLnRhYlR5cGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHd4LnNob3dUb2FzdCh7IHRpdGxlOiAn5Y+W5raI5pCc6JeP5oiQ5YqfJyB9KTtcclxuICAgICAgICAgICAgICAgIGhpc3Rvcnkuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGF0YSEoeyBoaXN0b3J5IH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goY29uc29sZS5sb2cpO1xyXG4gICAgfSxcclxuICAgIF9hd2FpdCgpIHtcclxuICAgICAgICB0aGlzLl9yZXF1ZXN0KCcvYXBpL2FjdGl2aXR5L3BhcnRpY2lwYXRpb24vbGlzdC9hd2FpdCcpO1xyXG4gICAgfSxcclxuICAgIF9hdWRpdGluZygpIHtcclxuICAgICAgICB0aGlzLl9yZXF1ZXN0KCcvYXBpL2FjdGl2aXR5L3BhcnRpY2lwYXRpb24vbGlzdC9hdWRpdGluZycpO1xyXG4gICAgfSxcclxuICAgIF9jb21wbGV0ZSgpIHtcclxuICAgICAgICB0aGlzLl9yZXF1ZXN0KCcvYXBpL2FjdGl2aXR5L3BhcnRpY2lwYXRpb24vbGlzdC9jb21wbGV0ZScpO1xyXG4gICAgfSxcclxuICAgIF9ldmFsdWF0ZSgpIHtcclxuICAgICAgICB0aGlzLl9yZXF1ZXN0KCcvYXBpL2FjdGl2aXR5L3BhcnRpY2lwYXRpb24vbGlzdC9ldmFsdWF0ZScpO1xyXG4gICAgfSxcclxuICAgIF9jb2xsZWN0aW9uKCkge1xyXG4gICAgICAgIGNvbnN0IHRhYlR5cGUgPSB0aGlzLmRhdGEudGFiVHlwZTtcclxuICAgICAgICByZXF1ZXN0PElDb21tb2RpdHlbXSB8IElBY3RpdmVbXT4oe1xyXG4gICAgICAgICAgICB1cmw6ICcvYXBpL2xpa2UnLFxyXG4gICAgICAgICAgICBkYXRhOiB7IHR5cGU6IHRhYlR5cGUgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKCh7IGRhdGEgfSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdCA9ICg8YW55W10+ZGF0YSkubWFwKHBhcnNlRGF0YSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzW3RhYlR5cGUgPyAnZ29vZHMnIDogJ2FjdGl2aXR5J10gPSBsaXN0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlzdG9yeTogbGlzdCxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0aGlzLmRhdGEudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICB0YWJUeXBlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgIH0sXHJcbiAgICBfcmVxdWVzdCh1cmw6IHN0cmluZykge1xyXG4gICAgICAgIHJlcXVlc3Q8SUFjdGl2ZVtdPih7IHVybCB9KVxyXG4gICAgICAgICAgICAudGhlbigoeyBkYXRhIH0pID0+IHRoaXMuc2V0RGF0YSEoeyB0eXBlOiB0aGlzLmRhdGEudHlwZSwgaGlzdG9yeTogZGF0YS5tYXAocGFyc2VEYXRhKSB9KSlcclxuICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgIH1cclxufSk7XHJcbiJdfQ==