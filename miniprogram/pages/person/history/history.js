"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var http_1 = require("../../../utils/http");
var constant_1 = require("../../../constant");
Page({
    data: {
        history: [],
        type: ''
    },
    onLoad: function (query) {
        this.data.type = query.type;
        var type = "_" + query.type;
        this[type] && this[type]();
        var titles = {
            await: '待参加',
            auditing: '待审核',
            complete: '已参加',
            toEvaluate: '待评价',
            initiate: '我的发起',
            collection: '我的收藏'
        };
        wx.setNavigationBarTitle({
            title: titles[query.type]
        });
    },
    delete: function (e) {
        var id = +e.target.dataset.id;
        wx.showModal({
            content: '删除该活动？',
            success: function (res) {
                if (res.confirm) {
                    console.log(id);
                }
            }
        });
    },
    none: function () {
    },
    _await: function () {
        this._request('/api/participation/await');
    },
    _auditing: function () {
        this._request('/api/participation/auditing');
    },
    _complete: function () {
        this._request('/api/participation/complete');
    },
    _request: function (url) {
        var _this = this;
        http_1.request({
            url: url,
            data: { userId: getApp().globalData.userId }
        })
            .then(function (_a) {
            var data = _a.data;
            return _this.setData({ type: _this.data.type, history: data.map(constant_1.parseData) });
        })
            .catch(console.log);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlzdG9yeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImhpc3RvcnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw0Q0FBOEM7QUFFOUMsOENBQThDO0FBSTlDLElBQUksQ0FBQztJQUNELElBQUksRUFBRTtRQUNGLE9BQU8sRUFBRSxFQUFlO1FBQ3hCLElBQUksRUFBRSxFQUFFO0tBQ1g7SUFDRCxNQUFNLFlBQUMsS0FBaUI7UUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQztRQUU1QixJQUFNLElBQUksR0FBZ0IsTUFBSSxLQUFLLENBQUMsSUFBTSxDQUFDO1FBQzNDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUUzQixJQUFNLE1BQU0sR0FBUTtZQUNoQixLQUFLLEVBQUUsS0FBSztZQUNaLFFBQVEsRUFBRSxLQUFLO1lBQ2YsUUFBUSxFQUFFLEtBQUs7WUFDZixVQUFVLEVBQUUsS0FBSztZQUNqQixRQUFRLEVBQUUsTUFBTTtZQUNoQixVQUFVLEVBQUUsTUFBTTtTQUNyQixDQUFDO1FBQ0YsRUFBRSxDQUFDLHFCQUFxQixDQUFDO1lBQ3JCLEtBQUssRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztTQUM1QixDQUFDLENBQUM7SUFDUCxDQUFDO0lBQ0QsTUFBTSxZQUFDLENBQWU7UUFDbEIsSUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7UUFDaEMsRUFBRSxDQUFDLFNBQVMsQ0FBQztZQUNULE9BQU8sRUFBRSxRQUFRO1lBQ2pCLE9BQU8sWUFBQyxHQUFHO2dCQUNQLElBQUksR0FBRyxDQUFDLE9BQU8sRUFBRTtvQkFDYixPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2lCQUNuQjtZQUNMLENBQUM7U0FDSixDQUFDLENBQUM7SUFDUCxDQUFDO0lBQ0QsSUFBSTtJQUVKLENBQUM7SUFHRCxNQUFNO1FBQ0YsSUFBSSxDQUFDLFFBQVEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0lBQzlDLENBQUM7SUFDRCxTQUFTO1FBQ0wsSUFBSSxDQUFDLFFBQVEsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFDRCxTQUFTO1FBQ0wsSUFBSSxDQUFDLFFBQVEsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFDRCxRQUFRLFlBQUMsR0FBVztRQUFwQixpQkFPQztRQU5HLGNBQU8sQ0FBWTtZQUNmLEdBQUcsS0FBQTtZQUNILElBQUksRUFBRSxFQUFFLE1BQU0sRUFBVyxNQUFNLEVBQUcsQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFO1NBQ3pELENBQUM7YUFDRyxJQUFJLENBQUMsVUFBQyxFQUFRO2dCQUFOLGNBQUk7WUFBTyxPQUFBLEtBQUksQ0FBQyxPQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsb0JBQVMsQ0FBQyxFQUFFLENBQUM7UUFBckUsQ0FBcUUsQ0FBQzthQUN6RixLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzVCLENBQUM7Q0FDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvaHR0cCc7XHJcbmltcG9ydCB7IElNeUFwcCB9IGZyb20gJy4uLy4uLy4uL2FwcCc7XHJcbmltcG9ydCB7IHBhcnNlRGF0YSB9IGZyb20gJy4uLy4uLy4uL2NvbnN0YW50JztcclxuXHJcbnR5cGUgSGlzdG9yeVR5cGUgPSAnX2F3YWl0JyB8ICdfYXVkaXRpbmcnIHwgJ19jb21wbGV0ZSc7XHJcblxyXG5QYWdlKHtcclxuICAgIGRhdGE6IHtcclxuICAgICAgICBoaXN0b3J5OiBbXSBhcyBJQWN0aXZlW10sXHJcbiAgICAgICAgdHlwZTogJydcclxuICAgIH0sXHJcbiAgICBvbkxvYWQocXVlcnk6IElBbnlPYmplY3QpIHtcclxuICAgICAgICB0aGlzLmRhdGEudHlwZSA9IHF1ZXJ5LnR5cGU7XHJcblxyXG4gICAgICAgIGNvbnN0IHR5cGUgPSA8SGlzdG9yeVR5cGU+YF8ke3F1ZXJ5LnR5cGV9YDtcclxuICAgICAgICB0aGlzW3R5cGVdICYmIHRoaXNbdHlwZV0oKTtcclxuXHJcbiAgICAgICAgY29uc3QgdGl0bGVzOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIGF3YWl0OiAn5b6F5Y+C5YqgJyxcclxuICAgICAgICAgICAgYXVkaXRpbmc6ICflvoXlrqHmoLgnLFxyXG4gICAgICAgICAgICBjb21wbGV0ZTogJ+W3suWPguWKoCcsXHJcbiAgICAgICAgICAgIHRvRXZhbHVhdGU6ICflvoXor4Tku7cnLFxyXG4gICAgICAgICAgICBpbml0aWF0ZTogJ+aIkeeahOWPkei1tycsXHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb246ICfmiJHnmoTmlLbol48nXHJcbiAgICAgICAgfTtcclxuICAgICAgICB3eC5zZXROYXZpZ2F0aW9uQmFyVGl0bGUoe1xyXG4gICAgICAgICAgICB0aXRsZTogdGl0bGVzW3F1ZXJ5LnR5cGVdXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgZGVsZXRlKGU6IFd4VG91Y2hFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IGlkID0gK2UudGFyZ2V0LmRhdGFzZXQuaWQ7XHJcbiAgICAgICAgd3guc2hvd01vZGFsKHtcclxuICAgICAgICAgICAgY29udGVudDogJ+WIoOmZpOivpea0u+WKqO+8nycsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3MocmVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLmNvbmZpcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBub25lKCkge1xyXG4gICAgICAgIC8vXHJcbiAgICB9LFxyXG5cclxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIF9hd2FpdCgpIHtcclxuICAgICAgICB0aGlzLl9yZXF1ZXN0KCcvYXBpL3BhcnRpY2lwYXRpb24vYXdhaXQnKTtcclxuICAgIH0sXHJcbiAgICBfYXVkaXRpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5fcmVxdWVzdCgnL2FwaS9wYXJ0aWNpcGF0aW9uL2F1ZGl0aW5nJyk7XHJcbiAgICB9LFxyXG4gICAgX2NvbXBsZXRlKCkge1xyXG4gICAgICAgIHRoaXMuX3JlcXVlc3QoJy9hcGkvcGFydGljaXBhdGlvbi9jb21wbGV0ZScpO1xyXG4gICAgfSxcclxuICAgIF9yZXF1ZXN0KHVybDogc3RyaW5nKSB7XHJcbiAgICAgICAgcmVxdWVzdDxJQWN0aXZlW10+KHtcclxuICAgICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgICBkYXRhOiB7IHVzZXJJZDogKDxJTXlBcHA+Z2V0QXBwKCkpLmdsb2JhbERhdGEudXNlcklkIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigoeyBkYXRhIH0pID0+IHRoaXMuc2V0RGF0YSEoeyB0eXBlOiB0aGlzLmRhdGEudHlwZSwgaGlzdG9yeTogZGF0YS5tYXAocGFyc2VEYXRhKSB9KSlcclxuICAgICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICAgIH1cclxufSk7XHJcbiJdfQ==